<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Sccin CallCenter Application System.">
    <meta name="author" content="linmuyi9999@163.com">
    <link rel="stylesheet" type="text/css" href="/themes/jsTree/style.min.css">
    <script type="text/javascript" src="/js/jquery-2.1.0.min.js"></script>
    <script type="text/javascript" src="/js/lib/jstree.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $('#jstree').on('changed.jstree', function (e, data) {
    var i, j, r = [];
    for(i = 0, j = data.selected.length; i < j; i++) {
     // r.push(data.instance.get_node(data.selected[i]).text);
     var id=data.instance.get_node(data.selected[i]).id;
     var text=data.instance.get_node(data.selected[i]).text;
     var pid=data.instance.get_parent(data.selected[i]);
     if(pid==='actions' ){
       // alert('actions:'+data.instance.get_node(data.selected[i]).id);
       

        window.parent.document.getElementById("ivraction").src="/pbx/ivracts/playback?id="+id+"&text="+text;
     }
     if(pid==='inputs'){
 //alert('inputs:'+data.instance.get_node(data.selected[i]).id)
     }
     
    }
    //$('#event_result').html('Selected: ' + r.join(', '));
  }).jstree({
                "core": {
                    "theme": {    "default": "small"},
                   // "check_callback" : true,
                    'data': [
                        {
                            'text': 'IVR<%= menuInst.id%>的执行动作',
                            "icon": '/images/ivr/bell.png',
                            "id":"actions",
                            'state': {
                                'opened': true,
                                'selected': false
                            },
                            //'children': '<%= inst%>'
                            'children':
                            [
                            <%for(var i=0;i<inst.length;i++){%>
                                { 'text': '<%= inst[i].text%>', "icon": '<%= inst[i].icon%>',"id":"<%= inst[i].id%>" },
                                <%}%>

                                /*{ 'text': '播放语音', "icon": '/images/ivr/pi206.png',"id":"nbbb1" },
                               {'text': '拨打电话', "icon": '/images/ivr/11.png',"id":"nbbb2" },
                                {'text': '录制字符', "icon": '/images/ivr/19-2.png',"id":"nbbb3" }*/
                            ]
                        },
                        {
                            'text':'IVR<%= menuInst.id%>的按键选择',
                            'icon':'/images/ivr/19-2.png',
                            "id":"inputs",
                            'state': {
                                'opened': true,
                                'selected': false
                            },
                            'children':[
                               { 'text': '无效按键', "icon": '/images/ivr/pi206.png',"id":"nbbb1" },
                               {'text': '输入超时', "icon": '/images/ivr/11.png',"id":"nbbb2" },
                               {'text': '重试次数', "icon": '/images/ivr/19-2.png',"id":"nbbb3" }
                            ]
                        }
                    ]
                },
               // "plugins":["dnd"]
            });
        });
    </script>
</head>
<body>
<div id="jstree">
</div>
</body>
</html>