/*! 数据库表结构 2014-04-02 */
var Schema=require("jugglingdb").Schema,moment=require("moment"),guid=require("guid"),conf=require("node-conf"),basedir=conf.load("app").appbase,schema=require("../database/jdmysql").schema,Dbs={},pbxCallProcees=schema.define("pbxCallProcees",{id:{type:String,length:100,"default":function(){return guid.create()}},callsession:{type:String,length:100},callernumber:{type:String,length:50},callednumber:{type:String,length:50},processname:{type:String,length:50},passargs:{type:String,length:100},doneresults:{type:String,length:50},routerline:{type:String,length:10},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});pbxCallProcees.Name="pbxCallProcees",schema.models.pbxCallProcees,exports.pbxCallProcees=pbxCallProcees,Dbs.pbxCallProcees=pbxCallProcees;var pbxCard=schema.define("pbxCard",{id:{type:String,length:100,"default":function(){return guid.create()}},cardname:{type:String,length:50},driver:{type:String,length:50,"default":function(){return"DAHDI"}},line:{type:Number},group:{type:String,length:10,"default":function(){return"-1"}},dataline:{type:String,length:10,"default":function(){return""}},trunkproto:{type:String,length:50}});pbxCard.Name="pbxCard",schema.models.pbxCard,exports.pbxCard=pbxCard,Dbs.pbxCard=pbxCard;var pbxCdr=schema.define("pbxCdr",{caller:{type:String,length:50},called:{type:String,length:50},accountcode:{type:String,length:50},srcchannel:{type:String,length:100},deschannel:{type:String,length:100},uniqueid:{type:String,length:50},threadid:{type:String,length:50},context:{type:String,length:50},agitype:{type:String,length:20},alive:{type:String,length:10,"default":function(){return"yes"}},startime:{type:String,length:100,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},lastapptime:{type:String,length:100,"default":function(){return""}},endtime:{type:String,length:100,"default":function(){return""}},routerline:{type:String,length:10},lastapp:{type:String,length:50},answerstatus:{type:String,length:50}});pbxCdr.Name="pbxCdr",schema.models.pbxCdr,exports.pbxCdr=pbxCdr,Dbs.pbxCdr=pbxCdr;var pbxConference=schema.define("pbxConference",{pincode:{type:String,length:50},playwhenevent:{type:Number,"default":function(){return 0}},mohwhenonlyone:{type:Number,"default":function(){return 0}},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});pbxConference.Name="pbxConference",schema.models.pbxConference,exports.pbxConference=pbxConference,Dbs.pbxConference=pbxConference;var pbxExtenGroupRelations=schema.define("pbxExtenGroupRelations",{id:{type:String,length:100,"default":function(){return guid.create()}},groupid:{type:Number},extenid:{type:String,length:50}});pbxExtenGroupRelations.Name="pbxExtenGroupRelations",schema.models.pbxExtenGroupRelations,exports.pbxExtenGroupRelations=pbxExtenGroupRelations,Dbs.pbxExtenGroupRelations=pbxExtenGroupRelations;var pbxExtenGroup=schema.define("pbxExtenGroup",{id:{type:String,length:100,"default":function(){return guid.create()}},groupname:{type:String,length:50},memo:{type:String,length:100},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});pbxExtenGroup.hasMany(pbxExtenGroupRelations,{as:"extensions",foreignKey:"groupid"}),pbxExtenGroup.Name="pbxExtenGroup",schema.models.pbxExtenGroup,exports.pbxExtenGroup=pbxExtenGroup,Dbs.pbxExtenGroup=pbxExtenGroup;var pbxExtension=schema.define("pbxExtension",{accountcode:{type:String,length:50},password:{type:String,length:50},deviceproto:{type:String,length:50},devicenumber:{type:String,length:50},devicestring:{type:String,length:100},fristchecked:{type:Number,"default":function(){return 0}},transfernumber:{type:String,length:50,"default":function(){return"deailway=&number="}},dndinfo:{type:String,length:10,"default":function(){return"off"}},failed:{type:String,length:50,"default":function(){return"deailway=hangup&number="}},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});pbxExtension.hasMany(pbxExtenGroupRelations,{as:"groups",foreignKey:"extenid"}),pbxExtension.validatesPresenceOf("accountcode","deviceproto"),pbxExtension.validatesLengthOf("password",{min:4,message:{min:"注册密码必须4位以上"}}),pbxExtension.validatesInclusionOf("deviceproto",{"in":["SIP","IAX2","VIRTUAL"]}),pbxExtension.validatesNumericalityOf("fristchecked",{"int":!0}),pbxExtension.Name="pbxExtension",schema.models.pbxExtension,exports.pbxExtension=pbxExtension,Dbs.pbxExtension=pbxExtension;var pbxIvrActMode=schema.define("pbxIvrActMode",{modename:{type:String,length:50},url:{type:String,length:100},iconame:{type:String,length:50},memo:{type:String,length:200}});pbxIvrActMode.Name="pbxIvrActMode",schema.models.pbxIvrActMode,exports.pbxIvrActMode=pbxIvrActMode,Dbs.pbxIvrActMode=pbxIvrActMode;var pbxIvrActions=schema.define("pbxIvrActions",{id:{type:String,length:100,"default":function(){return guid.create()}},ivrnumber:{type:String,length:50},ordinal:{type:Number,"default":function(){return 0}},actmode:{type:String,length:50,"default":function(){return"1"}},args:{type:String,length:256}});pbxIvrActions.belongsTo(pbxIvrActMode,{as:"Actmode",foreignKey:"actmode"}),pbxIvrActions.Name="pbxIvrActions",schema.models.pbxIvrActions,exports.pbxIvrActions=pbxIvrActions,Dbs.pbxIvrActions=pbxIvrActions;var pbxIvrInputs=schema.define("pbxIvrInputs",{id:{type:String,length:100,"default":function(){return guid.create()}},ivrnumber:{type:String,length:50},general:{type:Number,"default":function(){return 0}},generaltype:{type:String,length:50},generalargs:{type:String,length:150},inputnum:{type:String,length:10},gotoivrnumber:{type:String,length:50},gotoivractid:{type:Number,"default":function(){return 0}}});pbxIvrInputs.Name="pbxIvrInputs",schema.models.pbxIvrInputs,exports.pbxIvrInputs=pbxIvrInputs,Dbs.pbxIvrInputs=pbxIvrInputs;var pbxIvrMenmu=schema.define("pbxIvrMenmu",{ivrname:{type:String,length:50},description:{type:String,length:150},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},isreadonly:{type:String,length:10,"default":function(){return"否"}}});pbxIvrMenmu.hasMany(pbxIvrActions,{as:"actions",foreignKey:"ivrnumber"}),pbxIvrMenmu.hasMany(pbxIvrInputs,{as:"inputs",foreignKey:"ivrnumber"}),pbxIvrMenmu.Name="pbxIvrMenmu",schema.models.pbxIvrMenmu,exports.pbxIvrMenmu=pbxIvrMenmu,Dbs.pbxIvrMenmu=pbxIvrMenmu;var pbxLocalNumber=schema.define("pbxLocalNumber",{localtype:{type:String,length:50},assign:{type:String,length:100}});pbxLocalNumber.Name="pbxLocalNumber",schema.models.pbxLocalNumber,exports.pbxLocalNumber=pbxLocalNumber,Dbs.pbxLocalNumber=pbxLocalNumber;var pbxLostCall=schema.define("pbxLostCall",{id:{type:String,length:100,"default":function(){return guid.create()}},extension:{type:String,length:50},lostnumber:{type:String,length:50},lostType:{type:String,length:50,"default":function(){return""}},reback:{type:String,length:50,"default":function(){return"否"}},certime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},backtime:{type:String,length:50},whoback:{type:String,length:50}});pbxLostCall.Name="pbxLostCall",schema.models.pbxLostCall,exports.pbxLostCall=pbxLostCall,Dbs.pbxLostCall=pbxLostCall;var pbxQueue=schema.define("pbxQueue",{queuename:{type:String,length:50},announce:{type:String,length:50,"default":function(){return""}},playring:{type:Number,"default":function(){return 0}},saymember:{type:Number,"default":function(){return 0}},queuetimeout:{type:Number,"default":function(){return 0}},failedon:{type:String,length:50,"default":function(){return""}},members:{type:String,length:200},strategy:{type:String,length:50,"default":function(){return"random"}},wrapuptime:{type:Number,"default":function(){return 0}},timeout:{type:Number,"default":function(){return 0}},musicclass:{type:String,length:50,"default":function(){return"default"}},retry:{type:Number,"default":function(){return 0}},joinempty:{type:String,length:50,"default":function(){return"no"}},frequency:{type:Number,"default":function(){return 0}},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});pbxQueue.Name="pbxQueue",schema.models.pbxQueue,exports.pbxQueue=pbxQueue,Dbs.pbxQueue=pbxQueue;var pbxRcordFile=schema.define("pbxRcordFile",{id:{type:String,length:100,"default":function(){return guid.create()}},filename:{type:String,length:50},extname:{type:String,length:50},filesize:{type:Number,"default":function(){return 0}},calltype:{type:String,length:50},lable:{type:String,length:50},cretime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},extennum:{type:String,length:50},folder:{type:String,length:50},callnumber:{type:String,length:50},doymicac:{type:String,length:50}});pbxRcordFile.Name="pbxRcordFile",schema.models.pbxRcordFile,exports.pbxRcordFile=pbxRcordFile,Dbs.pbxRcordFile=pbxRcordFile;var pbxRouter=schema.define("pbxRouter",{id:{type:String,length:100,"default":function(){return guid.create()}},proirety:{type:Number},createmode:{type:String,length:10,"default":function(){return"否"}},routerline:{type:String,length:10,"default":function(){return"呼入"}},routername:{type:String,length:100},optextra:{type:String,length:50},lastwhendone:{type:String,length:10,"default":function(){return"否"}},callergroup:{type:String,length:50},callerid:{type:String,length:200},callerlen:{type:Number,"default":function(){return-1}},callednum:{type:String,length:50},calledlen:{type:Number,"default":function(){return-1}},replacecallerid:{type:String,length:50},replacecalledtrim:{type:Number,"default":function(){return-1}},replacecalledappend:{type:String,length:50},processmode:{type:String,length:50},processdefined:{type:String,length:100}});pbxRouter.Name="pbxRouter",schema.models.pbxRouter,exports.pbxRouter=pbxRouter,Dbs.pbxRouter=pbxRouter;var pbxScreenPop=schema.define("pbxScreenPop",{callernumber:{type:String,length:50,"default":function(){return""}},callednumber:{type:String,length:50,"default":function(){return""}},sessionnumber:{type:String,length:50,"default":function(){return""}},updatetime:{type:String,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},status:{type:String,length:10,"default":function(){return"over"}},routerdype:{type:Number,"default":function(){return 1}},parked:{type:String,length:50,"default":function(){return"not"}},poptype:{type:String,length:50,"default":function(){return""}}});pbxScreenPop.Name="pbxScreenPop",schema.models.pbxScreenPop,exports.pbxScreenPop=pbxScreenPop,Dbs.pbxScreenPop=pbxScreenPop;var pbxSounds=schema.define("pbxSounds",{id:{type:String,length:100,"default":function(){return guid.create()}},filename:{type:String,length:50},extname:{type:String,length:50},folder:{type:String,length:50},description:{type:String,length:100},label:{type:String,length:50},associate:{type:String,length:50},isreadonly:{type:Number,"default":function(){return 0}},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},args:{type:String,length:100}});pbxSounds.Name="pbxSounds",schema.models.pbxSounds,exports.pbxSounds=pbxSounds,Dbs.pbxSounds=pbxSounds;var pbxTrunk=schema.define("pbxTrunk",{trunkname:{type:String,length:50},trunkproto:{type:String,length:50},trunkprototype:{type:String,length:50,"default":function(){return""}},trunkdevice:{type:String,length:50,"default":function(){return""}},memo:{type:String,length:100,"default":function(){return""}},cretime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},args:{type:String,length:300,"default":function(){return""}}});pbxTrunk.validatesPresenceOf("trunkname","trunkproto"),pbxTrunk.Name="pbxTrunk",schema.models.pbxTrunk,exports.pbxTrunk=pbxTrunk,Dbs.pbxTrunk=pbxTrunk;var pbxMobileCode=schema.define("pbxMobileCode",{id:{type:String,length:100,"default":function(){return guid.create()}},haoduan:{type:String,length:10},number7:{type:String,length:20},server:{type:String,length:50},sheng:{type:String,length:50},shi:{type:String,length:50},quhao:{type:String,length:50},youbian:{type:String,length:20}});pbxMobileCode.Name="pbxMobileCode",schema.models.pbxMobileCode,exports.pbxMobileCode=pbxMobileCode,Dbs.pbxMobileCode=pbxMobileCode;var pbxBlacList=schema.define("pbxBlacList",{memo:{type:String,length:50,"default":function(){return""}},cretime:{type:String,length:100,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});pbxBlacList.Name="pbxBlacList",schema.models.pbxBlacList,exports.pbxBlacList=pbxBlacList,Dbs.pbxBlacList=pbxBlacList;var manageDepartments=schema.define("manageDepartments",{id:{type:String,length:100,"default":function(){return guid.create()}},depName:{type:String,length:50},crtTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},lastModify:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},memo:{type:String,length:200}});manageDepartments.validatesPresenceOf("depName"),manageDepartments.Name="manageDepartments",schema.models.manageDepartments,exports.manageDepartments=manageDepartments,Dbs.manageDepartments=manageDepartments;var manageMenmuRoleRelations=schema.define("manageMenmuRoleRelations",{id:{type:String,length:100,"default":function(){return guid.create()}},roleId:{type:String,length:100},menmuID:{type:String,length:100},crtTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});manageMenmuRoleRelations.Name="manageMenmuRoleRelations",schema.models.manageMenmuRoleRelations,exports.manageMenmuRoleRelations=manageMenmuRoleRelations,Dbs.manageMenmuRoleRelations=manageMenmuRoleRelations;var manageMenmus=schema.define("manageMenmus",{id:{type:String,length:100,"default":function(){return guid.create()}},menName:{type:String,length:50},menURL:{type:String,length:150},iconName:{type:String,length:150},mgID:{type:Number,"default":function(){return 1}},crtTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},width:{type:Number,"default":function(){return 960}},height:{type:Number,"default":function(){return 540}},ordernum:{type:Number,"default":function(){return 0}}});manageMenmus.validatesPresenceOf("menName","menURL","iconName"),manageMenmus.Name="manageMenmus",schema.models.manageMenmus,exports.manageMenmus=manageMenmus,Dbs.manageMenmus=manageMenmus;var manageUserRole=schema.define("manageUserRole",{id:{type:String,length:100,"default":function(){return guid.create()}},roleName:{type:String,length:50},isAgent:{type:String,length:10,"default":function(){return"否"}},hasPtions:{type:Number,"default":function(){return 0}},crtTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},lastModify:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},memo:{type:String,length:200}});manageUserRole.hasMany(manageMenmuRoleRelations,{as:"users",foreignKey:"roleId"}),manageUserRole.validatesPresenceOf("roleName"),manageUserRole.Name="manageUserRole",schema.models.manageUserRole,exports.manageUserRole=manageUserRole,Dbs.manageUserRole=manageUserRole;var manageUserInfo=schema.define("manageUserInfo",{id:{type:String,length:100,"default":function(){return guid.create()}},uName:{type:String,length:50},uCard:{type:String,length:100},uSex:{type:String,length:10,"default":function(){return"男"}},uLogin:{type:String,length:50},uPass:{type:String,length:100},uPhone:{type:String,length:50},uWorkNum:{type:String,length:50},uExten:{type:String,length:10},uAddr:{type:String,length:200},readOnly:{type:String,length:10,"default":function(){return"否"}},roleId:{type:String,length:100},depId:{type:String,length:100},uMemo:{type:String,limit:50},crtTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},lastChangeTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}},lastLoginTime:{type:Date,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});manageUserInfo.belongsTo(manageUserRole,{as:"role",foreignKey:"roleId"}),manageUserInfo.belongsTo(manageDepartments,{as:"department",foreignKey:"depId"}),manageUserInfo.validatesPresenceOf("uLogin","uName","uPass","uExten"),manageUserInfo.validatesLengthOf("uPass",{min:4,message:{min:"注册密码必须4位以上"}}),manageUserInfo.Name="manageUserInfo",schema.models.manageUserInfo,exports.manageUserInfo=manageUserInfo,Dbs.manageUserInfo=manageUserInfo;var crmCallRecords=schema.define("crmCallRecords",{CallInfoID:{type:String,length:50},ProjMoveID:{type:String,length:50},CallState:{type:Number,"default":0},WorkTime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});crmCallRecords.Name="crmCallRecords",schema.models.crmCallRecords,exports.crmCallRecords=crmCallRecords,Dbs.crmCallRecords=crmCallRecords;var crmCallPhone=schema.define("crmCallPhone",{callRecordsID:{type:String,length:50},Phone:{type:String,length:50},State:{type:Number,"default":0},PhoneSequ:{type:Number,"default":0}});crmCallPhone.belongsTo(crmCallRecords,{as:"callrecord",foreignKey:"callRecordsID"}),crmCallPhone.Name="crmCallPhone",schema.models.crmCallPhone,exports.crmCallPhone=crmCallPhone,Dbs.crmCallPhone=crmCallPhone;var crmCallLog=schema.define("crmCallLog",{Phone:{type:String,length:50},PhoneSequ:{type:Number,"default":0},WorkTime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});crmCallLog.Name="crmCallLog",crmCallLog.belongsTo(crmCallPhone,{as:"callphone",foreignKey:"id"}),schema.models.crmCallLog,exports.crmCallLog=crmCallLog,Dbs.crmCallLog=crmCallLog;var crmDialResult=schema.define("crmDialResult",{CallInfoID:{type:String,length:50},Result:{type:Number,"default":-1},State:{type:Number,"default":0},WorkTime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});crmDialResult.Name="crmDialResult",crmDialResult.belongsTo(crmCallRecords,{as:"callrecord",foreignKey:"id"}),schema.models.crmDialResult,exports.crmDialResult=crmDialResult,Dbs.crmDialResult=crmDialResult;var crmKeyType=schema.define("KeyType",{keyTypeID:{type:String,length:50},KeyTypeName:{type:String,length:50},State:{type:Number,"default":0}});crmKeyType.Name="crmKeyType",schema.models.crmKeyType,exports.crmKeyType=crmKeyType,Dbs.crmKeyType=crmKeyType;var crmUserKeysRecord=schema.define("crmUserKeysRecord",{callLogID:{type:String,length:50},keyTypeID:{type:String,length:50},Key:{type:String,length:50},WorkTime:{type:String,length:50,"default":function(){return moment().format("YYYY-MM-DD HH:mm:ss")}}});crmUserKeysRecord.Name="crmUserKeysRecord",crmUserKeysRecord.belongsTo(crmCallLog,{as:"calllog",foreignKey:"callLogID"}),crmUserKeysRecord.belongsTo(crmCallPhone,{as:"keytype",foreignKey:"keyTypeID"}),schema.models.crmUserKeysRecord,exports.crmUserKeysRecord=crmUserKeysRecord,Dbs.crmUserKeysRecord=crmUserKeysRecord;var crmVoiceContent=schema.define("crmVoiceContent",{NoticeContents:{type:Schema.Text},SureContents:{type:Schema.Text},QueryContents:{type:Schema.Text},State:{type:Number,"default":0}});crmVoiceContent.Name="crmVoiceContent",schema.models.crmVoiceContent,exports.crmVoiceContent=crmVoiceContent,Dbs.crmVoiceContent=crmVoiceContent,exports.Dbs=Dbs,schema.isActual(function(a,b){b?console.log("所有的表是最新的！"):schema.autoupdate(function(){console.log("更新表！")})});